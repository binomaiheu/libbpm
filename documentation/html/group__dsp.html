<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>libbpm: Digital Signal Processing Routines</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Digital Signal Processing Routines</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
<a class="anchor" name="dsp"></a><p>
This module contains the definitions for the digital signal processing routines for libbpm.<h2><a class="anchor" name="dsp_filtering">
The digital filtering routines</a></h2>
<h3><a class="anchor" name="dsp_filtering_usage">
General usage</a></h3>
Setup a filter using the <a class="el" href="group__dsp.html#g9a69282273c256d3fd7481652b360b93">create_filter()</a> routine. <div class="fragment"><pre class="fragment">    <a class="code" href="structfilter__t.html">filter_t</a> *filter = <a class="code" href="group__dsp.html#g9a69282273c256d3fd7481652b360b93">create_filter</a>( <span class="stringliteral">"the_filter"</span>, <a class="code" href="group__dsp.html#gfe7637a70564a23668795435de22932c">RESONATOR</a> | , 0,
                                       nsamples, 40.*kHz, 8.*kHz, 0., 200. );
</pre></div><p>
The arguments the filter expects is a name for the filter (just for esthetic purposes when printing the filter), the filter options, which are explained below, the order of the filter, where it is meaning full (e.g. Butterworth, Bessel, Chebyshev). Then it needs the number of samples in the waveforms which will be filtered by this filter, the sampling frequency and one (optionally two) frequency parameter. For lowpass/highpass filters and the resonater, only the first frequency defines respectively the -3dB frequency level for the low/high pass and the resonance frequency for the resonator (the witdh is defined by the Q value in this case). For bandpass/stop filters the two frequencies are required and define the -3dB level which defines the bandwidth of the filter, with f1 being the lower end frequency and f2 the higher end.<p>
The implemented filters are :<ul>
<li>BESSEL : Bessel IIR filter</li><li>BUTTERWORTH : Butterwordth IIR filter</li><li>CHEBYSHEV : Chebyshev IIR filter</li><li>RESONATOR : Resonators</li><li>GAUSSIAN : Non-causal Gaussian FIR filter</li></ul>
<p>
The IIR Bessel, Butterworth and Chebyshev filters can be normalised as lowpass (option LOWPASS) which is the default, highpass (option HIGHPASS), bandstop (option BANDSTOP) or bandpass (option BANDPASS) filters. They are designed with poles and zeros in the s plane that are transformed to the z plane either by bilinear z transform (option BILINEAR_Z_TRANSFORM) or matched z transform (option MATCHED_Z_TRANSFORM). Just "OR" the options together to setup the filter, e.g. :<p>
<div class="fragment"><pre class="fragment">    <a class="code" href="structfilter__t.html">filter_t</a> *filter = <a class="code" href="group__dsp.html#g9a69282273c256d3fd7481652b360b93">create_filter</a>( <span class="stringliteral">"lp"</span>, <a class="code" href="group__dsp.html#ga1703a42f41a941e1b8542e2aa7725b8">BESSEL</a> | <a class="code" href="group__dsp.html#gb55942c743e16f6629ad144214ced198">HIGHPASS</a> | <a class="code" href="group__dsp.html#g3760e0e98d0cc986cc0cd5ad69f327c8">MATCHED_Z_TRANSFORM</a>, 0,
                                       ns, 40.*kHz, 8.*kHz, 0., 200. );
</pre></div><p>
The resonators are designed directly with their 2 poles and 2 zeros in the z plane and can be normalised either as BANDPASS (default), BANDSTOP (or NOTCH) or ALLPASS resonators.<p>
The last argument to the <a class="el" href="group__dsp.html#g9a69282273c256d3fd7481652b360b93">create_filter()</a> routine is a parameter which can optionally be given to the filter. It depends on the filter chosen, currently the parameter has meaning for the following filters :<p>
<ul>
<li>BESSEL : the parameter defines the ripple in dB, has to be negative !</li><li>RESONATOR : the parameter gives the Q value of the resonator, if you want to have a pure oscillator (so infinite Q), then set the parameter to a negative number or zero.</li><li>GAUSSIAN : the filter cut-off parameter, or the fraction of the gaussian convolution function below which it is set to 0. (default is 0.001)</li></ul>
<p>
The filter coefficients for the difference equation are calculated and checked for consistency, upon which they are stored in the filter structure. Once this is done and the filter is setup, application to various waveforms is fairly straightforward. Note that you only have to define your filter once during initialisation. Once setup, it can be used to filter any number of waveforms of the same type.<p>
<div class="fragment"><pre class="fragment">    <a class="code" href="group__dsp.html#g06e897b615044a7169dc84b8eb4a7cfc">apply_filter</a>( filter, wave );
</pre></div><p>
To get an impulse response from the filter into the secified waveform, where the impulse is given at sample 1000, the following routine is implemented.<p>
<div class="fragment"><pre class="fragment">    <a class="code" href="group__dsp.html#gf12c84bb45e297f3bb0799341298942c">filter_impulse_response</a>( filter, wave, 1000 );
</pre></div><p>
This routine creates an impulse function (zero everywhere, except at the sample you enter, where it's value is 1) and puts it through the filter. The FFT of this impulse response gives you the filter characteristic in frequency domain. Also you can check the filter's response to a step function, it's so-called step response :<p>
<div class="fragment"><pre class="fragment">    <a class="code" href="group__dsp.html#g8ffa4c94e6673b1a73fe7266f1321e44">filter_step_response</a>( filter, wave, 1000 )
</pre></div><p>
The step response is defined as the response of the filter to an input function which is zero at the beginning and 1 for samples &gt;= the sample you specify.<h3><a class="anchor" name="dsp_filtering_bbc">
The Bessel, Butterworth and Chebyshev filters</a></h3>
<h3><a class="anchor" name="dsp_filtering_resonator">
The Resonator filter</a></h3>
<h3><a class="anchor" name="dsp_filtering_gaus">
The gaussian filter</a></h3>
The gaussian filter is implemented as a FIR convolution with both causal and anti-causal coefficients. Note that the frequency given is treated as the -3dB level for the gaussian. There is an option to restore the definition for bandwith which was used in early ESA processing, being the gaussian sigma, use GAUSSIAN_SIGMA_BW.<h2><a class="anchor" name="dsp_ddc">
The Digital Downconversion Algorithm (DDC)</a></h2>
The digital downconversion routine was developped to process digitised BPM waveforms and to retreive their position and amplitude. It basically implements an RF mixer in software. You need to supply it with the <a class="el" href="structdoublewf__t.html">doublewf_t</a> holding the waveform to mix down and the frequency for the software LO. Also you need to give a pointer to a low-pass filter in order to filter out the resulting double frequency component from the downmixing. The routine<p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">int</span> <a class="code" href="group__dsp.html#g9d8c64898ae5afc694d20c3b7224f728">ddc</a>( <a class="code" href="structdoublewf__t.html">doublewf_t</a> *w, <span class="keywordtype">double</span> f, <a class="code" href="structfilter__t.html">filter_t</a> *filter, <a class="code" href="structcomplexwf__t.html">complexwf_t</a> *dcw );
</pre></div><p>
returns then the complex DC waveform (dcw), where it's amplitude and phase can then be used in further calculations for beam position and slope in the BPM. We recommend the usage of a GAUSSIAN low-pass filter for the double frequency filtering as this shows the best phase behaviour combined with linearity (see <a class="el" href="group__dsp.html#g9a69282273c256d3fd7481652b360b93">create_filter()</a>).<p>
For fast execution, the DDC routine comes with a buffer which it only allocates once by doing<p>
<div class="fragment"><pre class="fragment">    <a class="code" href="group__dsp.html#gf449577391d3318d8434c5533e35336e">ddc_initialise</a>();
</pre></div><p>
This buffer is used in the filtering routine, you can clean up after the execution of the buffer by having<p>
<div class="fragment"><pre class="fragment">    <a class="code" href="group__dsp.html#g86ecee7954632e5f6588fab658ad57e4">ddc_cleanup</a>();
</pre></div><h2><a class="anchor" name="dsp_fft">
Discrete (Fast) Fourier Transforms</a></h2>
The FFT routines in the dsp section of libbpm are based upon the General Purpose FFT Package by Takuya OOURA, 1996-2001, see <a href="http://www.kurims.kyoto-u.ac.jp/~ooura/fft.html">http://www.kurims.kyoto-u.ac.jp/~ooura/fft.html</a> More specifically on it's split-radix fast version (fftsg). These set of routines needs a buffer for bitswapping an a buffer to store a table with sin and cos values so they needn't be calculated for every FFT. The routine<p>
<div class="fragment"><pre class="fragment">    <a class="code" href="group__dsp.html#gfc4c99bc5d39d6b118e1ccd629bc0967">fft_initialise</a>( <span class="keywordtype">int</span> ns )
</pre></div><p>
intialises the buffers for waveforms of a certain sample length ns. Note that ns has to be a power of 2. You can clear the FFT buffers by issuing<p>
<div class="fragment"><pre class="fragment">    <a class="code" href="group__dsp.html#gc994a163e29de65a3d7eaee79c91f6a7">fft_cleanup</a>( );
</pre></div><p>
Then two wrapper routines are implemented which take <a class="el" href="structdoublewf__t.html">doublewf_t</a> and <a class="el" href="structcomplexwf__t.html">complexwf_t</a> data.<h3><a class="anchor" name="dsp_fft_complex">
Complex Discrete Fourier Transform</a></h3>
The first one is<p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">int</span> <a class="code" href="group__dsp.html#g1c5a7dc710dd12ebdb8418623d0a3a91">complexfft</a>( <a class="code" href="structcomplexwf__t.html">complexwf_t</a> *z, <span class="keywordtype">int</span> fft_mode );
</pre></div><p>
which takes a complex waveform and performs an FFT in place. The fft_mode argument can be either<ul>
<li>FFT_FORWARD : forward discrete Fourier transform (plus-sign)</li></ul>
<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ X[k] = \sum_{j=0}^{n-1} x[j]*\exp(2*\pi*i*j*k/n), 0<=k<n \]" src="form_0.png">
<p>
<p>
<ul>
<li>FFT_BACKWARD : backward discrete Fourier transform (minus-sign)</li></ul>
<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ X[k] = \sum_{j=0}^{n-1} x[j]*\exp(-2*\pi*i*j*k/n), 0<=k<n \]" src="form_1.png">
<p>
<p>
Note the backward and forward FFT's have a factor of n inbetween them, so to get the orginal wf back after applying both the backward and the forward FFT, you need to divdide by the number of samples z-&gt;n.<h3><a class="anchor" name="dsp_fft_real">
Real Discrete Fourier Transform</a></h3>
The second routine implements the real discrete Fourier transform when having FFT_FORWARD and the other way around when having FFT_BACKWARD.<p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">int</span> <a class="code" href="group__dsp.html#g897fcf096d8b347969edcba67759d83e">realfft</a>( <a class="code" href="structdoublewf__t.html">doublewf_t</a> *y, <span class="keywordtype">int</span> fft_mode, <a class="code" href="structcomplexwf__t.html">complexwf_t</a> *z );
</pre></div><p>
So for FFT_FORWARD<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ Re( X[k] ) = \sum_{j=0}^{n-1} a[j]*\cos(2*\pi*j*k/n), 0<=k<=n/2 \]" src="form_2.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Im( X[k] ) = \sum_{j=0}^{n-1} a[j]*\sin(2*\pi*j*k/n), 0<k<n/2 \]" src="form_3.png">
<p>
<p>
and FFT_BACKWARD takes the input frmo the first half (n/2) of the <a class="el" href="structcomplexwf__t.html">complexwf_t</a> and FFTs it, expanding to a <a class="el" href="structdoublewf__t.html">doublewf_t</a> of length n.<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ X[k] = \frac{(Re(x[0]) + Re(x[n/2])*\cos(\pi*k) )}{2} + \sum_{j=1}^{n/2-1} Re(x[j])*\cos(2*\pi*j*k/n) + \sum_{j=1}^{n/2-1} Im(x[j])*\sin(2*\pi*j*k/n), 0<=k<n \]" src="form_4.png">
<p>
<h3><a class="anchor" name="dsp_fft_ref">
Reference for FFT routines</a></h3>
<ul>
<li>Masatake MORI, Makoto NATORI, Tatuo TORII: Suchikeisan, Iwanamikouzajyouhoukagaku18, Iwanami, 1982 (Japanese)</li><li>Henri J. Nussbaumer: Fast Fourier Transform and Convolution Algorithms, Springer Verlag, 1982</li><li>C. S. Burrus, Notes on the FFT (with large FFT paper list) <a href="http://www-dsp.rice.edu/research/fft/fftnote.asc">http://www-dsp.rice.edu/research/fft/fftnote.asc</a></li></ul>
<h3><a class="anchor" name="dsp_fft_copy">
Copyright statement for FFT routines</a></h3>
Copyright(C) 1996-2001 Takuya OOURA email: <a href="mailto:ooura@mmm.t.u-tokyo.ac.jp">ooura@mmm.t.u-tokyo.ac.jp</a> download: <a href="http://momonga.t.u-tokyo.ac.jp/~ooura/fft.html">http://momonga.t.u-tokyo.ac.jp/~ooura/fft.html</a> You may use, copy, modify this code for any purpose and without fee. You may distribute this ORIGINAL package.<h2><a class="anchor" name="dsp_examples">
DSP example program</a></h2>
There is an example program, which can be found in the examples directory under dsp. It shows how to work with the filtering and the DDC routines...<p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">    #include &lt;stdio.h&gt;</span>
<span class="preprocessor">    #include &lt;stdlib.h&gt;</span>
<span class="preprocessor">    #include &lt;string.h&gt;</span>
<span class="preprocessor">    #include &lt;math.h&gt;</span>

<span class="preprocessor">    #include &lt;iostream&gt;</span>
    
<span class="preprocessor">    #include &lt;TROOT.h&gt;</span>
<span class="preprocessor">    #include &lt;TFile.h&gt;</span>
<span class="preprocessor">    #include &lt;TTree.h&gt;</span>
    
<span class="preprocessor">    #include &lt;bpm/bpm_process.h&gt;</span>
<span class="preprocessor">    #include &lt;<a class="code" href="bpm__units_8h.html" title="Physical unit definitions for libbpm.">bpm/bpm_units.h</a>&gt;</span>
<span class="preprocessor">    #include &lt;bpm/bpm_simulation.h&gt;</span>
<span class="preprocessor">    #include &lt;bpm/bpm_nr.h&gt;</span>
<span class="preprocessor">    #include &lt;bpm/bpm_rf.h&gt;</span>
<span class="preprocessor">    #include &lt;bpm/bpm_dsp.h&gt;</span>
<span class="preprocessor">    #include &lt;bpm/bpm_wf.h&gt;</span>
    
    <span class="keyword">using namespace </span>std;

    <span class="keywordtype">int</span> main( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv ) {
    
      cout &lt;&lt; <span class="stringliteral">"Welcome to the libbpm DSP sandbox"</span> &lt;&lt; endl;
    
      <span class="keywordtype">int</span> ns    = 256;
      <span class="keywordtype">double</span> fs = 119.*MHz;
      
      <a class="code" href="structdoublewf__t.html">doublewf_t</a> *w = <a class="code" href="group__wave.html#gacd29427dda1a2dc73e05e438c3ccabd">doublewf</a>( ns, fs );
      <a class="code" href="structdoublewf__t.html">doublewf_t</a> *s = <a class="code" href="group__wave.html#g1bc161bf04ce585bbed17b175c4c6aea">doublewf_sample_series</a>( ns, fs );
      
      <a class="code" href="structdoublewf__t.html">doublewf_t</a> *ddc_amp   = <a class="code" href="group__wave.html#gacd29427dda1a2dc73e05e438c3ccabd">doublewf</a>( ns, fs );
      <a class="code" href="structdoublewf__t.html">doublewf_t</a> *ddc_phase = <a class="code" href="group__wave.html#gacd29427dda1a2dc73e05e438c3ccabd">doublewf</a>( ns, fs );
      
      <span class="comment">// setup the root trees...</span>
      TFile *rootfile = <span class="keyword">new</span> TFile( <span class="stringliteral">"dsp.root"</span>, <span class="stringliteral">"recreate"</span> );
      TTree *roottree = <span class="keyword">new</span> TTree( <span class="stringliteral">"dsp"</span>, <span class="stringliteral">"libbpm dsp tests"</span> );
      
      <span class="keywordtype">int</span> evt;
      <span class="keywordtype">double</span> amp, phase;
      <span class="keywordtype">double</span> gen_amp, gen_phase;
      
      <span class="comment">// setup the branches in the tree</span>
      roottree-&gt;Branch( <span class="stringliteral">"evt"</span>,       &amp;evt,          <span class="stringliteral">"evt/I"</span>            );
      roottree-&gt;Branch( <span class="stringliteral">"wf"</span>,        w-&gt;<a class="code" href="structdoublewf__t.html#dc4cb6d4fa6bd72c1c252d00cbf2f2a4">wf</a>,         <span class="stringliteral">"wf[256]/D"</span>        );
      roottree-&gt;Branch( <span class="stringliteral">"s"</span>,         s-&gt;<a class="code" href="structdoublewf__t.html#dc4cb6d4fa6bd72c1c252d00cbf2f2a4">wf</a>,         <span class="stringliteral">"s[256]/D"</span>         );
      roottree-&gt;Branch( <span class="stringliteral">"gen_amp"</span>,   &amp;gen_amp,      <span class="stringliteral">"gen_amp/D"</span>        );
      roottree-&gt;Branch( <span class="stringliteral">"gen_phase"</span>, &amp;gen_phase,    <span class="stringliteral">"gen_phase/D"</span>      );
      roottree-&gt;Branch( <span class="stringliteral">"ddc_amp"</span>,   ddc_amp-&gt;<a class="code" href="structdoublewf__t.html#dc4cb6d4fa6bd72c1c252d00cbf2f2a4">wf</a>,   <span class="stringliteral">"ddc_amp[256]/D"</span>   );
      roottree-&gt;Branch( <span class="stringliteral">"ddc_phase"</span>, ddc_phase-&gt;<a class="code" href="structdoublewf__t.html#dc4cb6d4fa6bd72c1c252d00cbf2f2a4">wf</a>, <span class="stringliteral">"ddc_phase[256]/D"</span> );
      
      <a class="code" href="structcomplexwf__t.html">complexwf_t</a> *ddcwf = <a class="code" href="group__wave.html#gf804f8cf9bfbd92719c3114bb68e1e91">complexwf</a>( ns, fs ); 

      <a class="code" href="structfilter__t.html">filter_t</a> *gauss  = <a class="code" href="group__dsp.html#g9a69282273c256d3fd7481652b360b93">create_filter</a>( <span class="stringliteral">"gauss"</span>, <a class="code" href="group__dsp.html#gd751f1b6909c0124a4ca151036b28a0e">GAUSSIAN</a>,0,ns,fs,6.*MHz,0.,0.001);
      <a class="code" href="structfilter__t.html">filter_t</a> *butter = <a class="code" href="group__dsp.html#g9a69282273c256d3fd7481652b360b93">create_filter</a>( <span class="stringliteral">"butter"</span>, <a class="code" href="group__dsp.html#g5d0a54629b87a77272d7979fa69eb0f4">BUTTERWORTH</a> | <a class="code" href="group__dsp.html#gb88b316b336dadc6e77f04d6f035d86e">LOWPASS</a>,4,ns,fs,6.*MHz,0.,0.);
      <a class="code" href="structfilter__t.html">filter_t</a> *bessel = <a class="code" href="group__dsp.html#g9a69282273c256d3fd7481652b360b93">create_filter</a>( <span class="stringliteral">"bessel"</span>, <a class="code" href="group__dsp.html#ga1703a42f41a941e1b8542e2aa7725b8">BESSEL</a> | <a class="code" href="group__dsp.html#gb88b316b336dadc6e77f04d6f035d86e">LOWPASS</a>,4,ns, fs,6.*MHz,0., 0.);
      <a class="code" href="structfilter__t.html">filter_t</a> *cheby  = <a class="code" href="group__dsp.html#g9a69282273c256d3fd7481652b360b93">create_filter</a>( <span class="stringliteral">"cheby"</span>,  <a class="code" href="group__dsp.html#g8d2af0f448fbf14aae730419d05e9aae">CHEBYSHEV</a> | <a class="code" href="group__dsp.html#gb88b316b336dadc6e77f04d6f035d86e">LOWPASS</a>,4,ns,fs,6.*MHz,0.,-10.);
      
      <span class="comment">// init the DDC</span>
      <a class="code" href="group__dsp.html#gf449577391d3318d8434c5533e35336e">ddc_initialise</a>( ns, fs );
      
      <span class="keywordflow">for</span> ( evt = 1; evt&lt;=1000; evt++ ) {
      
        <span class="comment">// Make the waveform</span>
        gen_amp   = (double) evt * 10.;
        gen_phase = PI / (double) evt;
        
        <span class="comment">// reset the w to 0... quite important :D</span>
        <a class="code" href="group__wave.html#ga75e86090de5e2d36afe24a6e5dd2f79">doublewf_reset</a>( w );
        
        <a class="code" href="group__wave.html#g19020b5ecb749bf036f012058764118d">doublewf_add_dcywave</a>( w, gen_amp, gen_phase, 21.4*MHz, 0.15*usec, 0.2*usec, 0. );
        
        <span class="comment">// do the DDC :)</span>
        <span class="keywordflow">if</span> ( <a class="code" href="group__dsp.html#g9d8c64898ae5afc694d20c3b7224f728">ddc</a>( w, 21.4*MHz, gauss, ddcwf ) ) <span class="keywordflow">return</span> 1;
        
        <span class="comment">// want to try differen filters ?</span>
        <span class="comment">//if ( ddc( w, 21.4*MHz, butter, ddcwf ) ) return 1;</span>
        <span class="comment">//if ( ddc( w, 21.4*MHz, bessel, ddcwf ) ) return 1;</span>
        <span class="comment">//if ( ddc( w, 21.4*MHz, cheby, ddcwf ) ) return 1;</span>
        
        
        <span class="comment">// get amplitude and phase from complex wf</span>
        <a class="code" href="group__wave.html#g1432cd70e6bec106888a64beec03dbba">complexwf_getamp</a>( ddc_amp, ddcwf );
        <a class="code" href="group__wave.html#g16bb6139e2f41c2de3053c383f3fe359">complexwf_getphase</a>( ddc_phase, ddcwf );
        
        <span class="comment">// fill the tree...</span>
        roottree-&gt;Fill();
        
        <span class="keywordflow">if</span> ( evt % 100 == 0 ) cout &lt;&lt; <span class="stringliteral">"Simulated "</span> &lt;&lt; evt &lt;&lt; <span class="stringliteral">" events."</span> &lt;&lt; endl;
      }    

      <span class="comment">// clear the DDC memory buffers</span>
      <a class="code" href="group__dsp.html#g86ecee7954632e5f6588fab658ad57e4">ddc_cleanup</a>();
      
      rootfile-&gt;Write();
      rootfile-&gt;Close();
      
      <a class="code" href="group__dsp.html#g182f6ed138d07cce1940be6c7dc7d843">delete_filter</a>( gauss );
      <a class="code" href="group__dsp.html#g182f6ed138d07cce1940be6c7dc7d843">delete_filter</a>( butter );
      <a class="code" href="group__dsp.html#g182f6ed138d07cce1940be6c7dc7d843">delete_filter</a>( bessel);
      <a class="code" href="group__dsp.html#g182f6ed138d07cce1940be6c7dc7d843">delete_filter</a>( cheby );
      
      <a class="code" href="group__wave.html#gb2b1590cb88d7e08ddcf185aa47de97e">complexwf_delete</a>( ddcwf );
      
      <a class="code" href="group__wave.html#gf9761d7316328c78183205bf4129df08">doublewf_delete</a>( w );
      <a class="code" href="group__wave.html#gf9761d7316328c78183205bf4129df08">doublewf_delete</a>( s );
      <a class="code" href="group__wave.html#gf9761d7316328c78183205bf4129df08">doublewf_delete</a>( ddc_amp );
      <a class="code" href="group__wave.html#gf9761d7316328c78183205bf4129df08">doublewf_delete</a>( ddc_phase );
      
      <span class="keywordflow">return</span> 0;
    }
</pre></div>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Files</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bpm__dsp_8h.html">bpm_dsp.h</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">libbpm digital signal processing routines <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="calculate__filter__coefficients_8c.html">calculate_filter_coefficients.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="create__filter_8c.html">create_filter.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="create__resonator__representation_8c.html">create_resonator_representation.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="create__splane__representation_8c.html">create_splane_representation.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ddc_8c.html">ddc.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="delete__filter_8c.html">delete_filter.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="discrete__fourier__transforms_8c.html">discrete_fourier_transforms.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="filter__impulse__response_8c.html">filter_impulse_response.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="filter__step__response_8c.html">filter_step_response.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="gaussian__filter__coeffs_8c.html">gaussian_filter_coeffs.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="norm__phase_8c.html">norm_phase.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="normalise__filter_8c.html">normalise_filter.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="print__filter_8c.html">print_filter.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="print__filter__representation_8c.html">print_filter_representation.c</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="zplane__transform_8c.html">zplane_transform.c</a></td></tr>

<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfilterrep__t.html">filterrep_t</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfilter__t.html">filter_t</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#ga1703a42f41a941e1b8542e2aa7725b8">BESSEL</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g5d0a54629b87a77272d7979fa69eb0f4">BUTTERWORTH</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g8d2af0f448fbf14aae730419d05e9aae">CHEBYSHEV</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#gad132a516e77ed236f2fc783d4a0a76a">RAISEDCOSINE</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#gfe7637a70564a23668795435de22932c">RESONATOR</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#gd751f1b6909c0124a4ca151036b28a0e">GAUSSIAN</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g2b8825fbaecce70ee62e88c392c3a5cc">BILINEAR_Z_TRANSFORM</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g3760e0e98d0cc986cc0cd5ad69f327c8">MATCHED_Z_TRANSFORM</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g00c885f3fbae267b1a194a1451c6c0fd">NO_PREWARP</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g1325d477c181914de6e34377f85e1782">CAUSAL</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g7ac031f6a8bf39034b82cb3910c5ae64">ANTICAUSAL</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g1ca4ab5665f98b5fa329196b585a591d">NONCAUSAL</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g542c0ef4de56e474ddde83cf0f4c7f75">GAUSSIAN_SIGMA_BW</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#gb88b316b336dadc6e77f04d6f035d86e">LOWPASS</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#gb55942c743e16f6629ad144214ced198">HIGHPASS</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g3ebfa4d7e384f53e6a37ff0d0d98627d">BANDPASS</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g889ef557cbf5adfd002eab3f69d59a4c">BANDSTOP</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#gfc5c94321c320b7db339b511e6905cce">NOTCH</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g88cf96ad30a3bdf745ac7cc883b4cc25">ALLPASS</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g34e4945cab9dbce5d535cd599409014d">FIR</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g67004975983f9c99226d63db17ba74c4">IIR</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g623810946946d9e0d69affd3906871cf">MAXORDER</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#ge6099fd066a0d0ccea7af9a725451cdd">MAXPZ</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g7782897f56b1db64e9aef60d5fcb8867">FILT_EPS</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g7eeaec212ff7b30e0f1aaea1f75090d2">MAX_RESONATOR_ITER</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g7769d6eabe1e3ec538cf182e453b0e9c">FFT_FORWARD</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g5fcdb491cd42667dc09e79aa17caea60">FFT_BACKWARD</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN <a class="el" href="structfilter__t.html">filter_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g9a69282273c256d3fd7481652b360b93">create_filter</a> (char name[], unsigned int options, int order, int ns, double fs, double f1, double f2, double par)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g06e897b615044a7169dc84b8eb4a7cfc">apply_filter</a> (<a class="el" href="structfilter__t.html">filter_t</a> *f, <a class="el" href="structdoublewf__t.html">doublewf_t</a> *w)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#gb1dc802390cc2794e545a635b833e819">print_filter</a> (FILE *of, <a class="el" href="structfilter__t.html">filter_t</a> *f)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g182f6ed138d07cce1940be6c7dc7d843">delete_filter</a> (<a class="el" href="structfilter__t.html">filter_t</a> *f)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g8ffa4c94e6673b1a73fe7266f1321e44">filter_step_response</a> (<a class="el" href="structfilter__t.html">filter_t</a> *f, <a class="el" href="structdoublewf__t.html">doublewf_t</a> *w, int itrig)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#gf12c84bb45e297f3bb0799341298942c">filter_impulse_response</a> (<a class="el" href="structfilter__t.html">filter_t</a> *f, <a class="el" href="structdoublewf__t.html">doublewf_t</a> *w, int itrig)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN <a class="el" href="structfilterrep__t.html">filterrep_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g22c12acc1f0031b41236dd009182f0b3">create_splane_representation</a> (<a class="el" href="structfilter__t.html">filter_t</a> *f)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN <a class="el" href="structfilterrep__t.html">filterrep_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g21615df94a81d7f49ebab1b94843b796">create_resonator_representation</a> (<a class="el" href="structfilter__t.html">filter_t</a> *f)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN <a class="el" href="structfilterrep__t.html">filterrep_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g56db3510d9bcff5794866f57edf626f8">zplane_transform</a> (<a class="el" href="structfilter__t.html">filter_t</a> *f, <a class="el" href="structfilterrep__t.html">filterrep_t</a> *s)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g77d84f27e5a88390cd5f263249256958">print_filter_representation</a> (FILE *of, <a class="el" href="structfilterrep__t.html">filterrep_t</a> *r)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g086b8f12f06df3ac5d3892c6c378346c">normalise_filter</a> (<a class="el" href="structfilter__t.html">filter_t</a> *f, <a class="el" href="structfilterrep__t.html">filterrep_t</a> *s)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#gd51e74023863f312dc8f78143203cdda">calculate_filter_coefficients</a> (<a class="el" href="structfilter__t.html">filter_t</a> *f)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#ga890982cd403efa5e312ab0877021d16">gaussian_filter_coeffs</a> (<a class="el" href="structfilter__t.html">filter_t</a> *f)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#gf174b4706cf2aa8dc8223d21e10b066a">_expand_complex_polynomial</a> (<a class="el" href="structcomplex__t.html">complex_t</a> *w, int n, <a class="el" href="structcomplex__t.html">complex_t</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN <a class="el" href="structcomplex__t.html">complex_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#gaa71bf94e489845a3c6f193146eecd51">_eval_complex_polynomial</a> (<a class="el" href="structcomplex__t.html">complex_t</a> *a, int n, <a class="el" href="structcomplex__t.html">complex_t</a> z)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#gf449577391d3318d8434c5533e35336e">ddc_initialise</a> (int ns, double fs)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g86ecee7954632e5f6588fab658ad57e4">ddc_cleanup</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g9d8c64898ae5afc694d20c3b7224f728">ddc</a> (<a class="el" href="structdoublewf__t.html">doublewf_t</a> *w, double f, <a class="el" href="structfilter__t.html">filter_t</a> *filter, <a class="el" href="structcomplexwf__t.html">complexwf_t</a> *dcw, <a class="el" href="structdoublewf__t.html">doublewf_t</a> *bufre, <a class="el" href="structdoublewf__t.html">doublewf_t</a> *bufim)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g0044b20270242b942305a7a8308751fa">fft_gen_tables</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#gfc4c99bc5d39d6b118e1ccd629bc0967">fft_initialise</a> (int ns)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#gc994a163e29de65a3d7eaee79c91f6a7">fft_cleanup</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g1c5a7dc710dd12ebdb8418623d0a3a91">complexfft</a> (<a class="el" href="structcomplexwf__t.html">complexwf_t</a> *z, int fft_mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g897fcf096d8b347969edcba67759d83e">realfft</a> (<a class="el" href="structdoublewf__t.html">doublewf_t</a> *y, int fft_mode, <a class="el" href="structcomplexwf__t.html">complexwf_t</a> *z)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">EXTERN void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dsp.html#g42ddaa15fe4fde56ada52d19ec786e8a">norm_phase</a> (double *phase)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="ga1703a42f41a941e1b8542e2aa7725b8"></a><!-- doxytag: member="bpm_dsp.h::BESSEL" ref="ga1703a42f41a941e1b8542e2aa7725b8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BESSEL          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Bitmask for Bessel filter 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00384">384</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>, and <a class="el" href="create__splane__representation_8c-source.html#l00032">create_splane_representation()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g5d0a54629b87a77272d7979fa69eb0f4"></a><!-- doxytag: member="bpm_dsp.h::BUTTERWORTH" ref="g5d0a54629b87a77272d7979fa69eb0f4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUTTERWORTH          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Bitmask for Butterworth filter 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00385">385</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>, and <a class="el" href="create__splane__representation_8c-source.html#l00032">create_splane_representation()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g8d2af0f448fbf14aae730419d05e9aae"></a><!-- doxytag: member="bpm_dsp.h::CHEBYSHEV" ref="g8d2af0f448fbf14aae730419d05e9aae" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHEBYSHEV          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Bitmask for Chebyshev filter 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00386">386</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>, and <a class="el" href="create__splane__representation_8c-source.html#l00032">create_splane_representation()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gad132a516e77ed236f2fc783d4a0a76a"></a><!-- doxytag: member="bpm_dsp.h::RAISEDCOSINE" ref="gad132a516e77ed236f2fc783d4a0a76a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAISEDCOSINE          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Bitmask for Raised Cosine filter 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00387">387</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="gfe7637a70564a23668795435de22932c"></a><!-- doxytag: member="bpm_dsp.h::RESONATOR" ref="gfe7637a70564a23668795435de22932c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RESONATOR          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Bitmask for Resonator filter 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00388">388</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>, and <a class="el" href="get__mode__response_8c-source.html#l00011">get_mode_response()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gd751f1b6909c0124a4ca151036b28a0e"></a><!-- doxytag: member="bpm_dsp.h::GAUSSIAN" ref="gd751f1b6909c0124a4ca151036b28a0e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GAUSSIAN          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Bitmask for Gaussian filter 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00389">389</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g2b8825fbaecce70ee62e88c392c3a5cc"></a><!-- doxytag: member="bpm_dsp.h::BILINEAR_Z_TRANSFORM" ref="g2b8825fbaecce70ee62e88c392c3a5cc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BILINEAR_Z_TRANSFORM          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get z poles via bilinear z transform from s plane 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00391">391</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="g3760e0e98d0cc986cc0cd5ad69f327c8"></a><!-- doxytag: member="bpm_dsp.h::MATCHED_Z_TRANSFORM" ref="g3760e0e98d0cc986cc0cd5ad69f327c8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MATCHED_Z_TRANSFORM          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get z poles via matches z transform from s plane 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00392">392</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="zplane__transform_8c-source.html#l00008">zplane_transform()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g00c885f3fbae267b1a194a1451c6c0fd"></a><!-- doxytag: member="bpm_dsp.h::NO_PREWARP" ref="g00c885f3fbae267b1a194a1451c6c0fd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NO_PREWARP          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Don't do the prewarp correction 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00393">393</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g1325d477c181914de6e34377f85e1782"></a><!-- doxytag: member="bpm_dsp.h::CAUSAL" ref="g1325d477c181914de6e34377f85e1782" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CAUSAL          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Filter is purely causal (only depends on past ) 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00394">394</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="apply__filter_8c-source.html#l00019">apply_filter()</a>, <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>, and <a class="el" href="print__filter_8c-source.html#l00008">print_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g7ac031f6a8bf39034b82cb3910c5ae64"></a><!-- doxytag: member="bpm_dsp.h::ANTICAUSAL" ref="g7ac031f6a8bf39034b82cb3910c5ae64" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ANTICAUSAL          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
.... purely anticausal (only depends on future) 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00395">395</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="apply__filter_8c-source.html#l00019">apply_filter()</a>, and <a class="el" href="print__filter_8c-source.html#l00008">print_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g1ca4ab5665f98b5fa329196b585a591d"></a><!-- doxytag: member="bpm_dsp.h::NONCAUSAL" ref="g1ca4ab5665f98b5fa329196b585a591d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NONCAUSAL          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Filter is both causal and acausal 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00396">396</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g542c0ef4de56e474ddde83cf0f4c7f75"></a><!-- doxytag: member="bpm_dsp.h::GAUSSIAN_SIGMA_BW" ref="g542c0ef4de56e474ddde83cf0f4c7f75" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GAUSSIAN_SIGMA_BW          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gaussian sigma bandwidth in stead of -3 dB (def) 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00397">397</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="gaussian__filter__coeffs_8c-source.html#l00008">gaussian_filter_coeffs()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gb88b316b336dadc6e77f04d6f035d86e"></a><!-- doxytag: member="bpm_dsp.h::LOWPASS" ref="gb88b316b336dadc6e77f04d6f035d86e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOWPASS          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Normalise filter as lowpass 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00399">399</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="calculate__filter__coefficients_8c-source.html#l00056">calculate_filter_coefficients()</a>, and <a class="el" href="normalise__filter_8c-source.html#l00007">normalise_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gb55942c743e16f6629ad144214ced198"></a><!-- doxytag: member="bpm_dsp.h::HIGHPASS" ref="gb55942c743e16f6629ad144214ced198" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HIGHPASS          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Normalise filter as highpass 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00400">400</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="calculate__filter__coefficients_8c-source.html#l00056">calculate_filter_coefficients()</a>, and <a class="el" href="normalise__filter_8c-source.html#l00007">normalise_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g3ebfa4d7e384f53e6a37ff0d0d98627d"></a><!-- doxytag: member="bpm_dsp.h::BANDPASS" ref="g3ebfa4d7e384f53e6a37ff0d0d98627d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BANDPASS          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Normalise filter as bandpass 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00401">401</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="calculate__filter__coefficients_8c-source.html#l00056">calculate_filter_coefficients()</a>, <a class="el" href="get__mode__response_8c-source.html#l00011">get_mode_response()</a>, and <a class="el" href="normalise__filter_8c-source.html#l00007">normalise_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g889ef557cbf5adfd002eab3f69d59a4c"></a><!-- doxytag: member="bpm_dsp.h::BANDSTOP" ref="g889ef557cbf5adfd002eab3f69d59a4c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BANDSTOP          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Normalise filter as bandstop 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00402">402</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="calculate__filter__coefficients_8c-source.html#l00056">calculate_filter_coefficients()</a>, <a class="el" href="create__resonator__representation_8c-source.html#l00015">create_resonator_representation()</a>, and <a class="el" href="normalise__filter_8c-source.html#l00007">normalise_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gfc5c94321c320b7db339b511e6905cce"></a><!-- doxytag: member="bpm_dsp.h::NOTCH" ref="gfc5c94321c320b7db339b511e6905cce" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NOTCH          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Normalise filter as notch filter (=bandstop) 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00403">403</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="g88cf96ad30a3bdf745ac7cc883b4cc25"></a><!-- doxytag: member="bpm_dsp.h::ALLPASS" ref="g88cf96ad30a3bdf745ac7cc883b4cc25" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ALLPASS          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Normalise filter as allpass ( resonator ) 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00404">404</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="create__resonator__representation_8c-source.html#l00015">create_resonator_representation()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g34e4945cab9dbce5d535cd599409014d"></a><!-- doxytag: member="bpm_dsp.h::FIR" ref="g34e4945cab9dbce5d535cd599409014d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FIR          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Filter is of FIR type 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00406">406</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="apply__filter_8c-source.html#l00019">apply_filter()</a>, and <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g67004975983f9c99226d63db17ba74c4"></a><!-- doxytag: member="bpm_dsp.h::IIR" ref="g67004975983f9c99226d63db17ba74c4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IIR          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Filter is of IIR type 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00407">407</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g623810946946d9e0d69affd3906871cf"></a><!-- doxytag: member="bpm_dsp.h::MAXORDER" ref="g623810946946d9e0d69affd3906871cf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXORDER          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Maximum filter order 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00409">409</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="ge6099fd066a0d0ccea7af9a725451cdd"></a><!-- doxytag: member="bpm_dsp.h::MAXPZ" ref="ge6099fd066a0d0ccea7af9a725451cdd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXPZ          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Maximum number of poles and zeros &gt;2*MAXORDER 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00410">410</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="calculate__filter__coefficients_8c-source.html#l00056">calculate_filter_coefficients()</a>, <a class="el" href="create__resonator__representation_8c-source.html#l00015">create_resonator_representation()</a>, and <a class="el" href="gaussian__filter__coeffs_8c-source.html#l00008">gaussian_filter_coeffs()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g7782897f56b1db64e9aef60d5fcb8867"></a><!-- doxytag: member="bpm_dsp.h::FILT_EPS" ref="g7782897f56b1db64e9aef60d5fcb8867" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FILT_EPS          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
A small number used in bpmdsp 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00411">411</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="calculate__filter__coefficients_8c-source.html#l00008">_expand_complex_polynomial()</a>, <a class="el" href="create__resonator__representation_8c-source.html#l00015">create_resonator_representation()</a>, and <a class="el" href="print__filter_8c-source.html#l00008">print_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g7eeaec212ff7b30e0f1aaea1f75090d2"></a><!-- doxytag: member="bpm_dsp.h::MAX_RESONATOR_ITER" ref="g7eeaec212ff7b30e0f1aaea1f75090d2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_RESONATOR_ITER          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Maximum iterations in resonator poles calculation 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00412">412</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="create__resonator__representation_8c-source.html#l00015">create_resonator_representation()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g7769d6eabe1e3ec538cf182e453b0e9c"></a><!-- doxytag: member="bpm_dsp.h::FFT_FORWARD" ref="g7769d6eabe1e3ec538cf182e453b0e9c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FFT_FORWARD          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Perform FFT from time -&gt; frequency 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00414">414</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="discrete__fourier__transforms_8c-source.html#l00178">complexfft()</a>, <a class="el" href="fft__waveform_8c-source.html#l00012">fft_waveform()</a>, and <a class="el" href="discrete__fourier__transforms_8c-source.html#l00230">realfft()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g5fcdb491cd42667dc09e79aa17caea60"></a><!-- doxytag: member="bpm_dsp.h::FFT_BACKWARD" ref="g5fcdb491cd42667dc09e79aa17caea60" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FFT_BACKWARD          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Perform FFT from frequency -&gt; time 
<p>Definition at line <a class="el" href="bpm__dsp_8h-source.html#l00415">415</a> of file <a class="el" href="bpm__dsp_8h-source.html">bpm_dsp.h</a>.</p>

<p>Referenced by <a class="el" href="discrete__fourier__transforms_8c-source.html#l00178">complexfft()</a>, and <a class="el" href="discrete__fourier__transforms_8c-source.html#l00230">realfft()</a>.</p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g9a69282273c256d3fd7481652b360b93"></a><!-- doxytag: member="bpm_dsp.h::create_filter" ref="g9a69282273c256d3fd7481652b360b93" args="(char name[], unsigned int options, int order, int ns, double fs, double f1, double f2, double par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN <a class="el" href="structfilter__t.html">filter_t</a>* create_filter           </td>
          <td>(</td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>name</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>fs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>par</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates the filter. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>a name for the filter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>options</em>&nbsp;</td><td>filter specification and options bitword </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>order</em>&nbsp;</td><td>filter order </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ns</em>&nbsp;</td><td>number of samples of the waveforms </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fs</em>&nbsp;</td><td>sampling frequency </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>f1</em>&nbsp;</td><td>first frequency </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>f2</em>&nbsp;</td><td>optional second frequency ( bandpass/bandstop ) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>par</em>&nbsp;</td><td>optional parameter<ul>
<li>for chebyshev : ripple in dB</li><li>for resonator : Q factor </li></ul>
</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A pointer to the created filter structure, memory is allocated on the heap inside this routine, the user has to take of deleting it using <a class="el" href="group__dsp.html#g182f6ed138d07cce1940be6c7dc7d843">delete_filter()</a>. </dd></dl>

<p>Definition at line <a class="el" href="create__filter_8c-source.html#l00010">10</a> of file <a class="el" href="create__filter_8c-source.html">create_filter.c</a>.</p>

<p>References <a class="el" href="bpm__dsp_8h-source.html#l00447">filter_t::alpha1</a>, <a class="el" href="bpm__dsp_8h-source.html#l00448">filter_t::alpha2</a>, <a class="el" href="bpm__dsp_8h-source.html#l00384">BESSEL</a>, <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, <a class="el" href="bpm__warning_8c-source.html#l00009">bpm_warning()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00385">BUTTERWORTH</a>, <a class="el" href="calculate__filter__coefficients_8c-source.html#l00056">calculate_filter_coefficients()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00394">CAUSAL</a>, <a class="el" href="bpm__dsp_8h-source.html#l00453">filter_t::cheb_ripple</a>, <a class="el" href="bpm__dsp_8h-source.html#l00386">CHEBYSHEV</a>, <a class="el" href="bpm__dsp_8h-source.html#l00462">filter_t::cplane</a>, <a class="el" href="create__resonator__representation_8c-source.html#l00015">create_resonator_representation()</a>, <a class="el" href="create__splane__representation_8c-source.html#l00032">create_splane_representation()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00444">filter_t::f1</a>, <a class="el" href="bpm__dsp_8h-source.html#l00445">filter_t::f2</a>, <a class="el" href="bpm__dsp_8h-source.html#l00406">FIR</a>, <a class="el" href="bpm__dsp_8h-source.html#l00443">filter_t::fs</a>, <a class="el" href="bpm__dsp_8h-source.html#l00455">filter_t::gauss_cutoff</a>, <a class="el" href="bpm__dsp_8h-source.html#l00389">GAUSSIAN</a>, <a class="el" href="gaussian__filter__coeffs_8c-source.html#l00008">gaussian_filter_coeffs()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00407">IIR</a>, <a class="el" href="bpm__dsp_8h-source.html#l00438">filter_t::name</a>, <a class="el" href="bpm__dsp_8h-source.html#l00393">NO_PREWARP</a>, <a class="el" href="bpm__dsp_8h-source.html#l00396">NONCAUSAL</a>, <a class="el" href="normalise__filter_8c-source.html#l00007">normalise_filter()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00428">filterrep_t::npoles</a>, <a class="el" href="bpm__dsp_8h-source.html#l00482">filter_t::ns</a>, <a class="el" href="bpm__dsp_8h-source.html#l00440">filter_t::options</a>, <a class="el" href="bpm__dsp_8h-source.html#l00441">filter_t::order</a>, <a class="el" href="bpm__dsp_8h-source.html#l00454">filter_t::Q</a>, <a class="el" href="bpm__dsp_8h-source.html#l00388">RESONATOR</a>, <a class="el" href="bpm__dsp_8h-source.html#l00450">filter_t::w_alpha1</a>, <a class="el" href="bpm__dsp_8h-source.html#l00451">filter_t::w_alpha2</a>, <a class="el" href="bpm__dsp_8h-source.html#l00483">filter_t::wfbuffer</a>, <a class="el" href="bpm__dsp_8h-source.html#l00471">filter_t::yc</a>, and <a class="el" href="zplane__transform_8c-source.html#l00008">zplane_transform()</a>.</p>

<p>Referenced by <a class="el" href="get__mode__response_8c-source.html#l00011">get_mode_response()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g06e897b615044a7169dc84b8eb4a7cfc"></a><!-- doxytag: member="bpm_dsp.h::apply_filter" ref="g06e897b615044a7169dc84b8eb4a7cfc" args="(filter_t *f, doublewf_t *w)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN int apply_filter           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfilter__t.html">filter_t</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdoublewf__t.html">doublewf_t</a> *&nbsp;</td>
          <td class="paramname"> <em>w</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Apply the filter to the given waveform. Note that the filter is applied in place, the user has to make a copy of the waveform if he/she wants to keep the original before applying the filter. The number of samples in the waveform has to be set in advance when creating the filter, it is stored in the filter structure (f-&gt;ns).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>pointer to a filter that was created using create_filter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wf</em>&nbsp;</td><td>an array containing the waveform to be filtered </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>BPM_SUCCESS upon success and BPM_FAILURE upon failure </dd></dl>

<p>Definition at line <a class="el" href="apply__filter_8c-source.html#l00019">19</a> of file <a class="el" href="apply__filter_8c-source.html">apply_filter.c</a>.</p>

<p>References <a class="el" href="bpm__dsp_8h-source.html#l00395">ANTICAUSAL</a>, <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00394">CAUSAL</a>, <a class="el" href="bpm__dsp_8h-source.html#l00406">FIR</a>, <a class="el" href="bpm__dsp_8h-source.html#l00460">filter_t::gain</a>, <a class="el" href="bpm__dsp_8h-source.html#l00482">filter_t::ns</a>, <a class="el" href="bpm__dsp_8h-source.html#l00464">filter_t::nxc</a>, <a class="el" href="bpm__dsp_8h-source.html#l00467">filter_t::nxc_ac</a>, <a class="el" href="bpm__dsp_8h-source.html#l00470">filter_t::nyc</a>, <a class="el" href="bpm__dsp_8h-source.html#l00440">filter_t::options</a>, <a class="el" href="bpm__wf_8h-source.html#l00177">doublewf_t::wf</a>, <a class="el" href="bpm__dsp_8h-source.html#l00483">filter_t::wfbuffer</a>, <a class="el" href="bpm__dsp_8h-source.html#l00465">filter_t::xc</a>, <a class="el" href="bpm__dsp_8h-source.html#l00468">filter_t::xc_ac</a>, <a class="el" href="bpm__dsp_8h-source.html#l00476">filter_t::xv</a>, <a class="el" href="bpm__dsp_8h-source.html#l00477">filter_t::xv_ac</a>, <a class="el" href="bpm__dsp_8h-source.html#l00471">filter_t::yc</a>, <a class="el" href="bpm__dsp_8h-source.html#l00479">filter_t::yv</a>, and <a class="el" href="bpm__dsp_8h-source.html#l00480">filter_t::yv_ac</a>.</p>

<p>Referenced by <a class="el" href="ddc_8c-source.html#l00078">ddc()</a>, <a class="el" href="filter__impulse__response_8c-source.html#l00007">filter_impulse_response()</a>, <a class="el" href="filter__step__response_8c-source.html#l00008">filter_step_response()</a>, <a class="el" href="generate__diodesignal_8c-source.html#l00011">generate_diodesignal()</a>, and <a class="el" href="get__mode__response_8c-source.html#l00011">get_mode_response()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gb1dc802390cc2794e545a635b833e819"></a><!-- doxytag: member="bpm_dsp.h::print_filter" ref="gb1dc802390cc2794e545a635b833e819" args="(FILE *of, filter_t *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN void print_filter           </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>of</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfilter__t.html">filter_t</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Prints the filter to the given file pointer. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>of</em>&nbsp;</td><td>the filepointer, use "stdout" to print to the terminal </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>the filter to be printed </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>Definition at line <a class="el" href="print__filter_8c-source.html#l00008">8</a> of file <a class="el" href="print__filter_8c-source.html">print_filter.c</a>.</p>

<p>References <a class="el" href="bpm__dsp_8h-source.html#l00395">ANTICAUSAL</a>, <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00394">CAUSAL</a>, <a class="el" href="bpm__dsp_8h-source.html#l00462">filter_t::cplane</a>, <a class="el" href="bpm__dsp_8h-source.html#l00457">filter_t::dc_gain</a>, <a class="el" href="bpm__dsp_8h-source.html#l00458">filter_t::fc_gain</a>, <a class="el" href="bpm__dsp_8h-source.html#l00411">FILT_EPS</a>, <a class="el" href="bpm__dsp_8h-source.html#l00460">filter_t::gain</a>, <a class="el" href="bpm__dsp_8h-source.html#l00459">filter_t::hf_gain</a>, <a class="el" href="bpm__dsp_8h-source.html#l00438">filter_t::name</a>, <a class="el" href="bpm__dsp_8h-source.html#l00464">filter_t::nxc</a>, <a class="el" href="bpm__dsp_8h-source.html#l00467">filter_t::nxc_ac</a>, <a class="el" href="bpm__dsp_8h-source.html#l00470">filter_t::nyc</a>, <a class="el" href="bpm__dsp_8h-source.html#l00440">filter_t::options</a>, <a class="el" href="print__filter__representation_8c-source.html#l00008">print_filter_representation()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00465">filter_t::xc</a>, <a class="el" href="bpm__dsp_8h-source.html#l00468">filter_t::xc_ac</a>, and <a class="el" href="bpm__dsp_8h-source.html#l00471">filter_t::yc</a>.</p>

</div>
</div><p>
<a class="anchor" name="g182f6ed138d07cce1940be6c7dc7d843"></a><!-- doxytag: member="bpm_dsp.h::delete_filter" ref="g182f6ed138d07cce1940be6c7dc7d843" args="(filter_t *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN void delete_filter           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfilter__t.html">filter_t</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Clears the memory that was allocated on the heap for the filter f. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>a pointer to the filter </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>Definition at line <a class="el" href="delete__filter_8c-source.html#l00007">7</a> of file <a class="el" href="delete__filter_8c-source.html">delete_filter.c</a>.</p>

<p>References <a class="el" href="bpm__dsp_8h-source.html#l00462">filter_t::cplane</a>, and <a class="el" href="bpm__dsp_8h-source.html#l00483">filter_t::wfbuffer</a>.</p>

<p>Referenced by <a class="el" href="get__mode__response_8c-source.html#l00011">get_mode_response()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g8ffa4c94e6673b1a73fe7266f1321e44"></a><!-- doxytag: member="bpm_dsp.h::filter_step_response" ref="g8ffa4c94e6673b1a73fe7266f1321e44" args="(filter_t *f, doublewf_t *w, int itrig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN int filter_step_response           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfilter__t.html">filter_t</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdoublewf__t.html">doublewf_t</a> *&nbsp;</td>
          <td class="paramname"> <em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>itrig</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This routine fills the given wf with the step response of the filter. The step response is defined as wf[i] = 0. for i &lt; itrig and wf[i] = 1. for i &gt;= itrig.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>a pointer to the filter to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wf</em>&nbsp;</td><td>pointer to a waveform which will be overwritten with the step response </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>itrig</em>&nbsp;</td><td>the sample number in the waveform which will have the step </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>BPM_SUCCESS upon succes and BPM_FAILURE upon failure </dd></dl>

<p>
Produces a stepresponse for the filter, step is defined by the trigger sample number the starting level and the endlevel 
<p>Definition at line <a class="el" href="filter__step__response_8c-source.html#l00008">8</a> of file <a class="el" href="filter__step__response_8c-source.html">filter_step_response.c</a>.</p>

<p>References <a class="el" href="apply__filter_8c-source.html#l00019">apply_filter()</a>, <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00482">filter_t::ns</a>, and <a class="el" href="bpm__wf_8h-source.html#l00177">doublewf_t::wf</a>.</p>

</div>
</div><p>
<a class="anchor" name="gf12c84bb45e297f3bb0799341298942c"></a><!-- doxytag: member="bpm_dsp.h::filter_impulse_response" ref="gf12c84bb45e297f3bb0799341298942c" args="(filter_t *f, doublewf_t *w, int itrig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN int filter_impulse_response           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfilter__t.html">filter_t</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdoublewf__t.html">doublewf_t</a> *&nbsp;</td>
          <td class="paramname"> <em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>itrig</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This routine fills the given wf with the impulse response of the filter. The impulse response is defined as wf[i] = 1. for i == itrig and wf[i] = 0. elsewhere.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>a pointer to the filter to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wf</em>&nbsp;</td><td>pointer to a waveform which will be overwritten with the impulse response </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>itrig</em>&nbsp;</td><td>the sample number in the waveform which will have the impulse </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>BPM_SUCCESS upon succes and BPM_FAILURE upon failure </dd></dl>

<p>
Produces an impulse response for the filter, step is defined by the trigger sample number the starting level and the endlevel 
<p>Definition at line <a class="el" href="filter__impulse__response_8c-source.html#l00007">7</a> of file <a class="el" href="filter__impulse__response_8c-source.html">filter_impulse_response.c</a>.</p>

<p>References <a class="el" href="apply__filter_8c-source.html#l00019">apply_filter()</a>, <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00482">filter_t::ns</a>, and <a class="el" href="bpm__wf_8h-source.html#l00177">doublewf_t::wf</a>.</p>

</div>
</div><p>
<a class="anchor" name="g22c12acc1f0031b41236dd009182f0b3"></a><!-- doxytag: member="bpm_dsp.h::create_splane_representation" ref="g22c12acc1f0031b41236dd009182f0b3" args="(filter_t *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN <a class="el" href="structfilterrep__t.html">filterrep_t</a>* create_splane_representation           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfilter__t.html">filter_t</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This routine returns a pointer to a filter representation <a class="el" href="structfilterrep__t.html">filterrep_t</a> in the s plane for Butterworth, Chebyshev and Bessel filters. It need an initialised filter structure which has the filter type and the order set. Memory is allocated for this routine on the heap, so the user is responsible to delete this memory using free().<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>the initialised filter with the correct options in f-&gt;options </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the filter representation in the s plane </dd></dl>

<p>Definition at line <a class="el" href="create__splane__representation_8c-source.html#l00032">32</a> of file <a class="el" href="create__splane__representation_8c-source.html">create_splane_representation.c</a>.</p>

<p>References <a class="el" href="bpm__dsp_8h-source.html#l00384">BESSEL</a>, <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00385">BUTTERWORTH</a>, <a class="el" href="bpm__dsp_8h-source.html#l00453">filter_t::cheb_ripple</a>, <a class="el" href="bpm__dsp_8h-source.html#l00386">CHEBYSHEV</a>, <a class="el" href="bpm__dsp_8h-source.html#l00428">filterrep_t::npoles</a>, <a class="el" href="bpm__dsp_8h-source.html#l00440">filter_t::options</a>, <a class="el" href="bpm__dsp_8h-source.html#l00441">filter_t::order</a>, and <a class="el" href="bpm__dsp_8h-source.html#l00430">filterrep_t::pole</a>.</p>

<p>Referenced by <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g21615df94a81d7f49ebab1b94843b796"></a><!-- doxytag: member="bpm_dsp.h::create_resonator_representation" ref="g21615df94a81d7f49ebab1b94843b796" args="(filter_t *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN <a class="el" href="structfilterrep__t.html">filterrep_t</a>* create_resonator_representation           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfilter__t.html">filter_t</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This routine returns a pointer to a filter representation <a class="el" href="structfilterrep__t.html">filterrep_t</a> in the z plane for resonance filters. It needs an initialised filter structure which has the filter type and the Q factor set. Memory is allocated for this routine on the heap, so the user is responsible to delete this memory using free().<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>the initialised filter with the correct options in f-&gt;options </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the filter representation in the z plane </dd></dl>

<p>Definition at line <a class="el" href="create__resonator__representation_8c-source.html#l00015">15</a> of file <a class="el" href="create__resonator__representation_8c-source.html">create_resonator_representation.c</a>.</p>

<p>References <a class="el" href="calculate__filter__coefficients_8c-source.html#l00044">_eval_complex_polynomial()</a>, <a class="el" href="calculate__filter__coefficients_8c-source.html#l00008">_expand_complex_polynomial()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00404">ALLPASS</a>, <a class="el" href="bpm__dsp_8h-source.html#l00447">filter_t::alpha1</a>, <a class="el" href="bpm__dsp_8h-source.html#l00402">BANDSTOP</a>, <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00411">FILT_EPS</a>, <a class="el" href="bpm__nr_8h-source.html#l00208">complex_t::im</a>, <a class="el" href="bpm__dsp_8h-source.html#l00412">MAX_RESONATOR_ITER</a>, <a class="el" href="bpm__dsp_8h-source.html#l00410">MAXPZ</a>, <a class="el" href="bpm__dsp_8h-source.html#l00428">filterrep_t::npoles</a>, <a class="el" href="bpm__dsp_8h-source.html#l00429">filterrep_t::nzeros</a>, <a class="el" href="bpm__dsp_8h-source.html#l00440">filter_t::options</a>, <a class="el" href="bpm__dsp_8h-source.html#l00430">filterrep_t::pole</a>, <a class="el" href="bpm__dsp_8h-source.html#l00454">filter_t::Q</a>, <a class="el" href="bpm__nr_8h-source.html#l00207">complex_t::re</a>, and <a class="el" href="bpm__dsp_8h-source.html#l00431">filterrep_t::zero</a>.</p>

<p>Referenced by <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g56db3510d9bcff5794866f57edf626f8"></a><!-- doxytag: member="bpm_dsp.h::zplane_transform" ref="g56db3510d9bcff5794866f57edf626f8" args="(filter_t *f, filterrep_t *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN <a class="el" href="structfilterrep__t.html">filterrep_t</a>* zplane_transform           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfilter__t.html">filter_t</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfilterrep__t.html">filterrep_t</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This routine transforms the poles and zeros for Bessel, Chebyshev and Butterworth filters to the z plane either via matched z transform or bilinear z transform. This is set in f-&gt;options. Memory is allocated for this routine on the heap, so the user is responsible to delete this memory using free().<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>the filter, needs the options from it to check how to transform </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>filter s plane poles and zeros </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>a pointer to the z plane representation </dd></dl>

<p>Definition at line <a class="el" href="zplane__transform_8c-source.html#l00008">8</a> of file <a class="el" href="zplane__transform_8c-source.html">zplane_transform.c</a>.</p>

<p>References <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00392">MATCHED_Z_TRANSFORM</a>, <a class="el" href="bpm__dsp_8h-source.html#l00428">filterrep_t::npoles</a>, <a class="el" href="bpm__dsp_8h-source.html#l00429">filterrep_t::nzeros</a>, <a class="el" href="bpm__dsp_8h-source.html#l00440">filter_t::options</a>, <a class="el" href="bpm__dsp_8h-source.html#l00430">filterrep_t::pole</a>, and <a class="el" href="bpm__dsp_8h-source.html#l00431">filterrep_t::zero</a>.</p>

<p>Referenced by <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g77d84f27e5a88390cd5f263249256958"></a><!-- doxytag: member="bpm_dsp.h::print_filter_representation" ref="g77d84f27e5a88390cd5f263249256958" args="(FILE *of, filterrep_t *r)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN void print_filter_representation           </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>of</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfilterrep__t.html">filterrep_t</a> *&nbsp;</td>
          <td class="paramname"> <em>r</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Prints the filter representation in terms of poles and zeros to the filepointer. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>of</em>&nbsp;</td><td>the filepointer, use "stdout" to print to the terminal </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>r</em>&nbsp;</td><td>the filter representation to be printed </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>
Display filter representation 
<p>Definition at line <a class="el" href="print__filter__representation_8c-source.html#l00008">8</a> of file <a class="el" href="print__filter__representation_8c-source.html">print_filter_representation.c</a>.</p>

<p>References <a class="el" href="bpm__dsp_8h-source.html#l00428">filterrep_t::npoles</a>, <a class="el" href="bpm__dsp_8h-source.html#l00429">filterrep_t::nzeros</a>, <a class="el" href="bpm__dsp_8h-source.html#l00430">filterrep_t::pole</a>, and <a class="el" href="bpm__dsp_8h-source.html#l00431">filterrep_t::zero</a>.</p>

<p>Referenced by <a class="el" href="print__filter_8c-source.html#l00008">print_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g086b8f12f06df3ac5d3892c6c378346c"></a><!-- doxytag: member="bpm_dsp.h::normalise_filter" ref="g086b8f12f06df3ac5d3892c6c378346c" args="(filter_t *f, filterrep_t *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN int normalise_filter           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfilter__t.html">filter_t</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfilterrep__t.html">filterrep_t</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Normalises the Butterworth, Chebyshev or Bessel filters to be Bandpass/stop or Low/Highpass <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>the filter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>the filter's representation in the s plane </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>BPM_SUCCESS upon success or BPM_FAILURE upon failure. </dd></dl>

<p>Definition at line <a class="el" href="normalise__filter_8c-source.html#l00007">7</a> of file <a class="el" href="normalise__filter_8c-source.html">normalise_filter.c</a>.</p>

<p>References <a class="el" href="bpm__dsp_8h-source.html#l00401">BANDPASS</a>, <a class="el" href="bpm__dsp_8h-source.html#l00402">BANDSTOP</a>, <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00400">HIGHPASS</a>, <a class="el" href="bpm__dsp_8h-source.html#l00399">LOWPASS</a>, <a class="el" href="bpm__dsp_8h-source.html#l00428">filterrep_t::npoles</a>, <a class="el" href="bpm__dsp_8h-source.html#l00429">filterrep_t::nzeros</a>, <a class="el" href="bpm__dsp_8h-source.html#l00440">filter_t::options</a>, <a class="el" href="bpm__dsp_8h-source.html#l00430">filterrep_t::pole</a>, <a class="el" href="bpm__dsp_8h-source.html#l00450">filter_t::w_alpha1</a>, <a class="el" href="bpm__dsp_8h-source.html#l00451">filter_t::w_alpha2</a>, and <a class="el" href="bpm__dsp_8h-source.html#l00431">filterrep_t::zero</a>.</p>

<p>Referenced by <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gd51e74023863f312dc8f78143203cdda"></a><!-- doxytag: member="bpm_dsp.h::calculate_filter_coefficients" ref="gd51e74023863f312dc8f78143203cdda" args="(filter_t *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN int calculate_filter_coefficients           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfilter__t.html">filter_t</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculates the filter coefficients from the z plane representation for Butterworth, Chebyshev, Bessel and Resonators. Before this routine is called, one has to make sure that the member cplane, which holds a pointer to the filter's representation in the complex plane is set. This routine than calculates the filter coefficients and stores them in f-&gt;xc ( coefficients of x[n], x[n-1], x[n-2]...) and f-&gt;yc ( coefficients of y[n-1], y[n-2], y[n-3], ... in case of IIR filters ).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>the filter, having it's f-&gt;cplane member set to the z plan representation </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>BPM_SUCCESS upon success or BPM_FAILURE upon failure. </dd></dl>

<p>
Calculates the filter coefficients from the poles and zeros in the cplane representation... Also calculates the filter gains... 
<p>Definition at line <a class="el" href="calculate__filter__coefficients_8c-source.html#l00056">56</a> of file <a class="el" href="calculate__filter__coefficients_8c-source.html">calculate_filter_coefficients.c</a>.</p>

<p>References <a class="el" href="calculate__filter__coefficients_8c-source.html#l00044">_eval_complex_polynomial()</a>, <a class="el" href="calculate__filter__coefficients_8c-source.html#l00008">_expand_complex_polynomial()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00447">filter_t::alpha1</a>, <a class="el" href="bpm__dsp_8h-source.html#l00448">filter_t::alpha2</a>, <a class="el" href="bpm__dsp_8h-source.html#l00401">BANDPASS</a>, <a class="el" href="bpm__dsp_8h-source.html#l00402">BANDSTOP</a>, <a class="el" href="bpm__dsp_8h-source.html#l00462">filter_t::cplane</a>, <a class="el" href="bpm__dsp_8h-source.html#l00457">filter_t::dc_gain</a>, <a class="el" href="bpm__dsp_8h-source.html#l00458">filter_t::fc_gain</a>, <a class="el" href="bpm__dsp_8h-source.html#l00460">filter_t::gain</a>, <a class="el" href="bpm__dsp_8h-source.html#l00459">filter_t::hf_gain</a>, <a class="el" href="bpm__dsp_8h-source.html#l00400">HIGHPASS</a>, <a class="el" href="bpm__dsp_8h-source.html#l00399">LOWPASS</a>, <a class="el" href="bpm__dsp_8h-source.html#l00410">MAXPZ</a>, <a class="el" href="bpm__dsp_8h-source.html#l00428">filterrep_t::npoles</a>, <a class="el" href="bpm__dsp_8h-source.html#l00464">filter_t::nxc</a>, <a class="el" href="bpm__dsp_8h-source.html#l00470">filter_t::nyc</a>, <a class="el" href="bpm__dsp_8h-source.html#l00429">filterrep_t::nzeros</a>, <a class="el" href="bpm__dsp_8h-source.html#l00440">filter_t::options</a>, <a class="el" href="bpm__dsp_8h-source.html#l00430">filterrep_t::pole</a>, <a class="el" href="bpm__dsp_8h-source.html#l00465">filter_t::xc</a>, <a class="el" href="bpm__dsp_8h-source.html#l00471">filter_t::yc</a>, and <a class="el" href="bpm__dsp_8h-source.html#l00431">filterrep_t::zero</a>.</p>

<p>Referenced by <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ga890982cd403efa5e312ab0877021d16"></a><!-- doxytag: member="bpm_dsp.h::gaussian_filter_coeffs" ref="ga890982cd403efa5e312ab0877021d16" args="(filter_t *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN int gaussian_filter_coeffs           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfilter__t.html">filter_t</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculates the gaussian filter coefficients from the original gaussian filter implementation in the digital downconversion algortithm in Yury's code. Note that this filter is implemented as a FIR non-causal filter. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>the filter structure with the coefficients to fill </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>BPM_SUCCESS upon success or BPM_FAILURE upon failure. </dd></dl>

<p>Definition at line <a class="el" href="gaussian__filter__coeffs_8c-source.html#l00008">8</a> of file <a class="el" href="gaussian__filter__coeffs_8c-source.html">gaussian_filter_coeffs.c</a>.</p>

<p>References <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, <a class="el" href="dround_8c-source.html#l00006">dround()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00444">filter_t::f1</a>, <a class="el" href="bpm__dsp_8h-source.html#l00443">filter_t::fs</a>, <a class="el" href="bpm__dsp_8h-source.html#l00460">filter_t::gain</a>, <a class="el" href="bpm__dsp_8h-source.html#l00455">filter_t::gauss_cutoff</a>, <a class="el" href="bpm__dsp_8h-source.html#l00397">GAUSSIAN_SIGMA_BW</a>, <a class="el" href="bpm__dsp_8h-source.html#l00410">MAXPZ</a>, <a class="el" href="bpm__dsp_8h-source.html#l00482">filter_t::ns</a>, <a class="el" href="bpm__dsp_8h-source.html#l00464">filter_t::nxc</a>, <a class="el" href="bpm__dsp_8h-source.html#l00467">filter_t::nxc_ac</a>, <a class="el" href="bpm__dsp_8h-source.html#l00440">filter_t::options</a>, <a class="el" href="bpm__dsp_8h-source.html#l00465">filter_t::xc</a>, and <a class="el" href="bpm__dsp_8h-source.html#l00468">filter_t::xc_ac</a>.</p>

<p>Referenced by <a class="el" href="create__filter_8c-source.html#l00010">create_filter()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gf174b4706cf2aa8dc8223d21e10b066a"></a><!-- doxytag: member="bpm_dsp.h::_expand_complex_polynomial" ref="gf174b4706cf2aa8dc8223d21e10b066a" args="(complex_t *w, int n, complex_t *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN int _expand_complex_polynomial           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcomplex__t.html">complex_t</a> *&nbsp;</td>
          <td class="paramname"> <em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcomplex__t.html">complex_t</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Helper routine to expand a complex polynomial from a set of zeros. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>w</em>&nbsp;</td><td>array of complex zeros for the polynomial </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>n</em>&nbsp;</td><td>nunber of zeros </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>array of coeffiecients for the polynomial that is returned </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>BPM_SUCCESS upon success or BPM_FAILURE upon failure. </dd></dl>

<p>
Calculate the polynomial coefficients in a0 + a1 * z + a2 * z^2 + a3 * z^3 + ... = (z-w1)(z-w2)(z-w3)... from the n polynomial's zero's "w" returns the results in a, the array of coefficients... 
<p>Definition at line <a class="el" href="calculate__filter__coefficients_8c-source.html#l00008">8</a> of file <a class="el" href="calculate__filter__coefficients_8c-source.html">calculate_filter_coefficients.c</a>.</p>

<p>References <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, and <a class="el" href="bpm__dsp_8h-source.html#l00411">FILT_EPS</a>.</p>

<p>Referenced by <a class="el" href="calculate__filter__coefficients_8c-source.html#l00056">calculate_filter_coefficients()</a>, and <a class="el" href="create__resonator__representation_8c-source.html#l00015">create_resonator_representation()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gaa71bf94e489845a3c6f193146eecd51"></a><!-- doxytag: member="bpm_dsp.h::_eval_complex_polynomial" ref="gaa71bf94e489845a3c6f193146eecd51" args="(complex_t *a, int n, complex_t z)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN <a class="el" href="structcomplex__t.html">complex_t</a> _eval_complex_polynomial           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcomplex__t.html">complex_t</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcomplex__t.html">complex_t</a>&nbsp;</td>
          <td class="paramname"> <em>z</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Helper routine to evaluate a complex polynomial for value z <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>array of coeffiecients for the polynomial that is returned </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>n</em>&nbsp;</td><td>number of zeros </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>z</em>&nbsp;</td><td>the value for which to evalute the polynomial </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the value of the polynomial for z ( <a class="el" href="structcomplex__t.html">complex_t</a> ) </dd></dl>

<p>Definition at line <a class="el" href="calculate__filter__coefficients_8c-source.html#l00044">44</a> of file <a class="el" href="calculate__filter__coefficients_8c-source.html">calculate_filter_coefficients.c</a>.</p>

<p>Referenced by <a class="el" href="calculate__filter__coefficients_8c-source.html#l00056">calculate_filter_coefficients()</a>, and <a class="el" href="create__resonator__representation_8c-source.html#l00015">create_resonator_representation()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gf449577391d3318d8434c5533e35336e"></a><!-- doxytag: member="bpm_dsp.h::ddc_initialise" ref="gf449577391d3318d8434c5533e35336e" args="(int ns, double fs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN int ddc_initialise           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>fs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialises and allocates memory for the DDC buffers with the correct number of samples and sampling frequency <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ns</em>&nbsp;</td><td>Nuber of samples in waveforms to be processed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fs</em>&nbsp;</td><td>The sampling frequency of the waveforms </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>BPM_SUCCESS upon success, BPM_FAILURE upon failure </dd></dl>

<p>Definition at line <a class="el" href="ddc_8c-source.html#l00050">50</a> of file <a class="el" href="ddc_8c-source.html">ddc.c</a>.</p>

<p>References <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, and <a class="el" href="doublewf_8c-source.html#l00008">doublewf()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g86ecee7954632e5f6588fab658ad57e4"></a><!-- doxytag: member="bpm_dsp.h::ddc_cleanup" ref="g86ecee7954632e5f6588fab658ad57e4" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN void ddc_cleanup           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Clears up and frees the buffer memory for the ddc routines 
<p>Definition at line <a class="el" href="ddc_8c-source.html#l00070">70</a> of file <a class="el" href="ddc_8c-source.html">ddc.c</a>.</p>

<p>References <a class="el" href="doublewf_8c-source.html#l00202">doublewf_delete()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g9d8c64898ae5afc694d20c3b7224f728"></a><!-- doxytag: member="bpm_dsp.h::ddc" ref="g9d8c64898ae5afc694d20c3b7224f728" args="(doublewf_t *w, double f, filter_t *filter, complexwf_t *dcw, doublewf_t *bufre, doublewf_t *bufim)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ddc           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdoublewf__t.html">doublewf_t</a> *&nbsp;</td>
          <td class="paramname"> <em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfilter__t.html">filter_t</a> *&nbsp;</td>
          <td class="paramname"> <em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcomplexwf__t.html">complexwf_t</a> *&nbsp;</td>
          <td class="paramname"> <em>dcw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdoublewf__t.html">doublewf_t</a> *&nbsp;</td>
          <td class="paramname"> <em>bufre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdoublewf__t.html">doublewf_t</a> *&nbsp;</td>
          <td class="paramname"> <em>bufim</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Do a digital downconversion on the waveform f. The routine returns a complex DC waveform "wdc". If the buffer arguments are NULL pointers, the DDC routine will use an internal buffer. This is a good option when all the BPMs in the system have the same sampling frequency and number of samples. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>w</em>&nbsp;</td><td>The waveform of doubles to process </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>The frequency of the digital local oscillator </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>filter</em>&nbsp;</td><td>The lowpass filter to get rid of the 2omega component </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dcw</em>&nbsp;</td><td>The complex DC waveform </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bufre</em>&nbsp;</td><td>The real ddc buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bufim</em>&nbsp;</td><td>The imaginary ddc buffer </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>BPM_SUCCESS upon success, BPM_FAILURE upon failure </dd></dl>

<p>Definition at line <a class="el" href="ddc_8c-source.html#l00078">78</a> of file <a class="el" href="ddc_8c-source.html">ddc.c</a>.</p>

<p>References <a class="el" href="apply__filter_8c-source.html#l00019">apply_filter()</a>, <a class="el" href="complexwf_8c-source.html#l00579">complexwf_setimag()</a>, <a class="el" href="complexwf_8c-source.html#l00557">complexwf_setreal()</a>, <a class="el" href="bpm__wf_8h-source.html#l00176">doublewf_t::fs</a>, <a class="el" href="bpm__wf_8h-source.html#l00190">complexwf_t::fs</a>, <a class="el" href="bpm__wf_8h-source.html#l00175">doublewf_t::ns</a>, <a class="el" href="bpm__wf_8h-source.html#l00189">complexwf_t::ns</a>, and <a class="el" href="bpm__wf_8h-source.html#l00177">doublewf_t::wf</a>.</p>

<p>Referenced by <a class="el" href="ddc__waveform_8c-source.html#l00012">ddc_waveform()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g0044b20270242b942305a7a8308751fa"></a><!-- doxytag: member="bpm_dsp.h::fft_gen_tables" ref="g0044b20270242b942305a7a8308751fa" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN int fft_gen_tables           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Regenerates the sin/cos tables that are needed for the fast DFT algorithm. 
<p>Definition at line <a class="el" href="discrete__fourier__transforms_8c-source.html#l00116">116</a> of file <a class="el" href="discrete__fourier__transforms_8c-source.html">discrete_fourier_transforms.c</a>.</p>

<p>References <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>.</p>

<p>Referenced by <a class="el" href="discrete__fourier__transforms_8c-source.html#l00130">fft_initialise()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gfc4c99bc5d39d6b118e1ccd629bc0967"></a><!-- doxytag: member="bpm_dsp.h::fft_initialise" ref="gfc4c99bc5d39d6b118e1ccd629bc0967" args="(int ns)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN int fft_initialise           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ns</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This one initialised the FFT buffers, checks whether they are large enough for the given number of samples and frees and re-allocates memory where necessary <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ns</em>&nbsp;</td><td>The number of samples in the waveforms to be transformed </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>BPM_SUCCESS upon succes, BPM_FAILURE upon failure </dd></dl>

<p>Definition at line <a class="el" href="discrete__fourier__transforms_8c-source.html#l00130">130</a> of file <a class="el" href="discrete__fourier__transforms_8c-source.html">discrete_fourier_transforms.c</a>.</p>

<p>References <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, and <a class="el" href="discrete__fourier__transforms_8c-source.html#l00116">fft_gen_tables()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gc994a163e29de65a3d7eaee79c91f6a7"></a><!-- doxytag: member="bpm_dsp.h::fft_cleanup" ref="gc994a163e29de65a3d7eaee79c91f6a7" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN void fft_cleanup           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This routine frees up the memory used by the FFT buffers 
<p>Definition at line <a class="el" href="discrete__fourier__transforms_8c-source.html#l00163">163</a> of file <a class="el" href="discrete__fourier__transforms_8c-source.html">discrete_fourier_transforms.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="g1c5a7dc710dd12ebdb8418623d0a3a91"></a><!-- doxytag: member="bpm_dsp.h::complexfft" ref="g1c5a7dc710dd12ebdb8418623d0a3a91" args="(complexwf_t *z, int fft_mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN int complexfft           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcomplexwf__t.html">complexwf_t</a> *&nbsp;</td>
          <td class="paramname"> <em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fft_mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Executes a complex fast fourier transform in line. See the reference guide for details. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>z</em>&nbsp;</td><td>The complex waveform to transform (original waveform is destroyed) Note that the number of samples need to be a power of 2. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fft_mode</em>&nbsp;</td><td>Specifies whether to do the forward or backward transform </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>BPM_SUCCESS upon succes, BPM_FAILURE upon failure </dd></dl>

<p>Definition at line <a class="el" href="discrete__fourier__transforms_8c-source.html#l00178">178</a> of file <a class="el" href="discrete__fourier__transforms_8c-source.html">discrete_fourier_transforms.c</a>.</p>

<p>References <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, <a class="el" href="bpm__warning_8c-source.html#l00009">bpm_warning()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00415">FFT_BACKWARD</a>, <a class="el" href="bpm__dsp_8h-source.html#l00414">FFT_FORWARD</a>, <a class="el" href="bpm__nr_8h-source.html#l00208">complex_t::im</a>, <a class="el" href="bpm__wf_8h-source.html#l00189">complexwf_t::ns</a>, <a class="el" href="bpm__nr_8h-source.html#l00207">complex_t::re</a>, and <a class="el" href="bpm__wf_8h-source.html#l00191">complexwf_t::wf</a>.</p>

</div>
</div><p>
<a class="anchor" name="g897fcf096d8b347969edcba67759d83e"></a><!-- doxytag: member="bpm_dsp.h::realfft" ref="g897fcf096d8b347969edcba67759d83e" args="(doublewf_t *y, int fft_mode, complexwf_t *z)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN int realfft           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdoublewf__t.html">doublewf_t</a> *&nbsp;</td>
          <td class="paramname"> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fft_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcomplexwf__t.html">complexwf_t</a> *&nbsp;</td>
          <td class="paramname"> <em>z</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Executes a real fast fourier transform, between the real waveform y and the complex waveform z. See documentation for further explanation. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>y</em>&nbsp;</td><td>Pointer to the real wavefrom </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fft_mode</em>&nbsp;</td><td>Specifies whether to do the forward or backward transform </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>z</em>&nbsp;</td><td>Pointer to the complex waveform </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>BPM_SUCCESS upon succes, BPM_FAILURE upon failure </dd></dl>

<p>Definition at line <a class="el" href="discrete__fourier__transforms_8c-source.html#l00230">230</a> of file <a class="el" href="discrete__fourier__transforms_8c-source.html">discrete_fourier_transforms.c</a>.</p>

<p>References <a class="el" href="bpm__error_8c-source.html#l00009">bpm_error()</a>, <a class="el" href="bpm__warning_8c-source.html#l00009">bpm_warning()</a>, <a class="el" href="bpm__dsp_8h-source.html#l00415">FFT_BACKWARD</a>, <a class="el" href="bpm__dsp_8h-source.html#l00414">FFT_FORWARD</a>, <a class="el" href="bpm__nr_8h-source.html#l00208">complex_t::im</a>, <a class="el" href="bpm__wf_8h-source.html#l00189">complexwf_t::ns</a>, <a class="el" href="bpm__nr_8h-source.html#l00207">complex_t::re</a>, <a class="el" href="bpm__wf_8h-source.html#l00191">complexwf_t::wf</a>, and <a class="el" href="bpm__wf_8h-source.html#l00177">doublewf_t::wf</a>.</p>

<p>Referenced by <a class="el" href="fft__waveform_8c-source.html#l00012">fft_waveform()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g42ddaa15fe4fde56ada52d19ec786e8a"></a><!-- doxytag: member="bpm_dsp.h::norm_phase" ref="g42ddaa15fe4fde56ada52d19ec786e8a" args="(double *phase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXTERN void norm_phase           </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>phase</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Normalises the phase, to the interval [0,2pi[ <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>phase</em>&nbsp;</td><td>Pointer to the phase value to normalise </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="norm__phase_8c-source.html#l00008">8</a> of file <a class="el" href="norm__phase_8c-source.html">norm_phase.c</a>.</p>

<p>Referenced by <a class="el" href="complexwf_8c-source.html#l00532">complexwf_getphase()</a>, <a class="el" href="complexwf_8c-source.html#l00676">complexwf_getphase_new()</a>, <a class="el" href="postprocess__waveform_8c-source.html#l00010">postprocess_waveform()</a>, <a class="el" href="process__caltone_8c-source.html#l00011">process_caltone()</a>, and <a class="el" href="process__waveform_8c-source.html#l00012">process_waveform()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Jun 25 17:32:49 2008 for libbpm by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
